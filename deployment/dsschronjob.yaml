apiVersion: batch/v1
kind: CronJob
metadata:
  name: fetch-secret-cronjob
spec:
  schedule: "* * * * *" # This schedule runs the job every minute
  jobTemplate:
    spec:
      template:
        spec:
          containers:
          - name: fetch-secret-mywebappdb
            image: s001elk2.konsalt.info:5555/dssfetchsecret:1.3
            imagePullPolicy: IfNotPresent
            env:
            - name: SECRET_SERVER_URL
              value: "https://pam.konsalt.info/SecretServer"
            - name: SECRET_ID
              value: "144"
            - name: USERNAME
              value: "argocd"
            - name: PASSWORD
              value: "Kon123_5!!"
            - name: DOMAIN
              value: "Local"
          restartPolicy: OnFailure
